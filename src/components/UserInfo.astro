---

---

<script>
  import * as jose from 'jose'
  const handleLogout = () => {
    localStorage.removeItem('access_token')
    localStorage.removeItem('refresh_token')
    window.location.href = '/login'
  }
  document.getElementById('logout')?.addEventListener('click', handleLogout)

  // load access token
  const accessToken = localStorage.getItem('access_token')
  const claims = accessToken && jose.decodeJwt(accessToken)
  // set username
  const username = claims?.sub as string
  const nameEl = document.getElementById('username')
  nameEl && username && (nameEl.innerHTML = username)

  // handle click on avatar
  const avatarEl = document.getElementById('avatar')
  const userDetailEl = document.getElementById('user-detail')
  avatarEl?.addEventListener('click', () => {
    userDetailEl?.classList.toggle('hidden')
  })
</script>

<div>
  <div class='flex h-fit space-x-2 items-center mr-4 pt-4 shrink'>
    <div class='text-center space-y-2'>
      <img
        class='w-10 h-10 rounded-full block w-fit mx-auto'
        src={`https://i.pravatar.cc/100`}
        alt={`avatar`}
        id='avatar'
      />
    </div>
    <div class='i-heroicons:chevron-down-16-solid w-1em h-1em'></div>
  </div>
  <div id='user-detail' class='relative mt-2 hidden'>
    <div
      class='absolute right-2 bg-indigo-100 w-fit rounded-lg overflow-hidden text-center space-y-2 backdrop-blur-sm text-gray-800 z-10'>
      <div class='bg-indigo-200 w-full p-4 space-y-2'>
        <img
          class='w-14 h-14 rounded-full w-fit mx-auto'
          src={`https://i.pravatar.cc/100`}
          alt={`avatar`}
        />
        <div class='text-xs' id='username'></div>
      </div>
      <div class='px-4 pb-4 space-y-2'>
        <a class='text-xs block' href='#'>Setting</a>
        <a class='text-xs block' href='#'>Help</a>
        <a id='logout' class='text-xs block' href='#'> Logout </a>
      </div>
    </div>
  </div>
</div>
